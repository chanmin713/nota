# Tab 기반 Fill(FIM) 동작(초안)

## 목적
- Word/Sentence/Paragraph 단위 제안 제공, Tab/→/클릭/타이핑으로 수락/거부

## 기본 설정
- 기본 그레인: Sentence (사용자 설정으로 변경 가능)
- 입력 컨텍스트: prefix/suffix 300–800 tokens

## 수락/거부 제스처
- Tab: 현재 고스트 제안 수락
- →: 수락(보조), Esc: 숨김
- 타이핑 충돌: 사용자가 입력하면 제안 취소(자동)

## 후보 생성/재랭킹
- 후보 2–3개 생성 → 경량 cross‑encoder 재랭킹 → 상위 1개 고스트 노출
- 멱등성: 동일 컨텍스트에서 반복 호출 시 동일 제안 유지(시간 제한 내)

## 정지 규칙(개요)
- Word: 공백/구두점 단위
- Sentence: 종료 구두점(., !, ?) + 한국어 종결 보정
- Paragraph: 빈 줄/블록 경계

## 지연 예산(95p)
- Word ≤ 80ms, Sentence ≤ 150ms, Paragraph 300–800ms
- 타임스탬프 로깅 및 주간 95p 보고(telemetry 연계)

## UI/UX
- 고스트 텍스트 대비/명도 준수(WCAG AA)
- 수락 후 커서 위치: 제안 끝으로 이동, Undo 경계 설정

## 예외
- 코드 블록/수식 블록 내에서는 기본 OFF(토글로 변경 가능)
